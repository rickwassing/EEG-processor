function GroupAnalysis_htmlreport(GLM)
% ==================================================
% Init
% --------------------------------------------------
i = zeros(100, 1);
FullFilePath = fullfile(fileparts(GLM.filepath), 'report.html');
% --------------------------------------------------
S = struct();
S.title = sprintf('EEG Processor %s (%s)', GLM.modeltype, GLM.model.ModelSpec);
% ==================================================
% ROW
% --------------------------------------------------
l = 1; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
S.c(i(1)).el = 'div';
S.c(i(1)).class = 'row pt-3';
% ==================================================
% COLUMNS
% --------------------------------------------------
l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Column: 1
S.c(i(1)).c(i(2)).el = 'div';
S.c(i(1)).c(i(2)).class = 'col-xs-12 col-sm-4 col-md-5 col-lg-4 col-xl-3 mb-3';
% --------------------------------------------------
l = 3; i(l) = i(l) + 1; i(l+1:end) = 0;
% ==================================================
% CARD
% --------------------------------------------------
% Card to show model specifications
% --------------------------------------------------
S.c(i(1)).c(i(2)).c(i(3)).el = 'div';
S.c(i(1)).c(i(2)).c(i(3)).class = 'card h-100';
% --------------------------------------------------
l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card header
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'card-header';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).content = 'Model';
% --------------------------------------------------
l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'card-body';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Data type';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'p';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'card-text';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = GLM.inputfiletype;
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Model type';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'p';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'card-text';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = GLM.modeltype;
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Number of permutations';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'p';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'card-text';
if GLM.poststats.MaxPermutations > GLM.poststats.NumPermutations
    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = sprintf('%i', GLM.poststats.NumPermutations);
else
    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = sprintf('%.0f', GLM.poststats.MaxPermutations);
end
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Permutation method';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'p';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'card-text';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = GLM.poststats.Method;
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Shufflings';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'p';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'card-text';
str = '';
if GLM.poststats.DoPermutations
    str = [str, 'permutations'];
end
if GLM.poststats.DoSignFlips
    if ~isempty(str)
        str = [str, ' and '];
    end
    str = [str, 'sign-flips'];
end
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = str;
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Permute blocks';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'p';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'card-text';
str = '';
if GLM.poststats.PermWhole
    str = [str, 'whole-blocks'];
end
if GLM.poststats.PermWithin
    if ~isempty(str)
        str = [str, ' and '];
    end
    str = [str, 'within-blocks'];
end
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = str;
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Significance level';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'p';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'card-text';
switch GLM.poststats.Method
    case {'ClusterMass', 'ClusterExtent'}
        str = sprintf('alpha = %.3f (channel-wise)<br />alpha =  %.3f (cluster)', GLM.poststats.ChanWiseAlpha, GLM.poststats.ClusterAlpha);
    otherwise
        str = sprintf('alpha = %.3f', GLM.poststats.ChanWiseAlpha);
end
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = str;
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'hr';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Surface';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'img';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'w-100';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).data_bs_toggle = 'modal';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).data_bs_target = '#modal-topomap';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).src = 'images/surface.png';
% --------------------------------------------------
l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
% ==================================================
% Column: 2
% --------------------------------------------------
S.c(i(1)).c(i(2)).el = 'div';
S.c(i(1)).c(i(2)).class = 'col-xs-12 col-sm-8 col-md-7 col-lg-5 col-xl-4 mb-3';
% --------------------------------------------------
l = 3; i(l) = i(l) + 1; i(l+1:end) = 0;
% ==================================================
% CARD
% --------------------------------------------------
% Card to show design matrix
% --------------------------------------------------
S.c(i(1)).c(i(2)).c(i(3)).el = 'div';
S.c(i(1)).c(i(2)).c(i(3)).class = 'card h-100';
% --------------------------------------------------
l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card header
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'card-header';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).content = 'Model specification';
% --------------------------------------------------
l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'card-body';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Formula';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'p';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'card-text';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = GLM.model.ModelSpec;
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Design matrix';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Card body content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'img';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'w-100';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).src = 'images/designmatrix.png';
% ==================================================
% F-STATISTICS
% --------------------------------------------------
if isfield(GLM.result, 'f')
    % ==================================================
    % ROW
    % --------------------------------------------------
    l = 1; i(l) = i(l) + 1; i(l+1:end) = 0;
    % --------------------------------------------------
    S.c(i(1)).el = 'div';
    S.c(i(1)).class = 'row';
    % ==================================================
    % Row title
    % --------------------------------------------------
    l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
    % --------------------------------------------------
    S.c(i(1)).c(i(2)).el = 'hr';
    % --------------------------------------------------
    l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
    % --------------------------------------------------
    S.c(i(1)).c(i(2)).el = 'h3';
    S.c(i(1)).c(i(2)).class = 'mb-3';
    S.c(i(1)).c(i(2)).content = 'F-tests';
    % --------------------------------------------------
    for m = 1:length(GLM.result)
        % ==================================================
        % COLUMNS
        % --------------------------------------------------
        l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Column: 1
        S.c(i(1)).c(i(2)).el = 'div';
        S.c(i(1)).c(i(2)).class = 'col-xs-6 col-sm-6 col-md-3 col-lg-3 col-xl-2 mb-3';
        % --------------------------------------------------
        l = 3; i(l) = i(l) + 1; i(l+1:end) = 0;
        % ==================================================
        % CARD
        S.c(i(1)).c(i(2)).c(i(3)).el = 'div';
        S.c(i(1)).c(i(2)).c(i(3)).class = 'card h-100 mb-3';
        % --------------------------------------------------
        l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Card header
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'card-header text-capitalize fw-bold';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).content = sprintf('%s', GLM.result(m).label);
        % --------------------------------------------------
        l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Card body
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'card-body pb-0';
        for c = 1:length(GLM.result(m).f)
            if c > 1
                % --------------------------------------------------
                l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Card body content
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'hr';
            end
            % --------------------------------------------------
            l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Card body content
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'd-inline';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = GLM.result(m).f(c).title;
            % --------------------------------------------------
            l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Card body content
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'button';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).type = 'button';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'btn btn-outline-secondary btn-sm float-end px-1 py-0';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).data_bs_toggle = 'modal';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).data_bs_target = sprintf('#modal-f-m%i-c%i', m, c);
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'details';
            % --------------------------------------------------
            l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Card body content
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'img';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'd-block w-100 mt-3';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).style = 'max-width: 255px;';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).src = sprintf('images/result_f_m%i_c%i.png', m, c);
        end
    end
end
% ==================================================
% T-STATISTICS
% ==================================================
% ROW
% --------------------------------------------------
l = 1; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
S.c(i(1)).el = 'div';
S.c(i(1)).class = 'row';
% ==================================================
% Row title
% --------------------------------------------------
l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
S.c(i(1)).c(i(2)).el = 'hr';
% --------------------------------------------------
l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
S.c(i(1)).c(i(2)).el = 'h3';
S.c(i(1)).c(i(2)).class = 'mb-3';
S.c(i(1)).c(i(2)).content = 'T-contrasts';
% --------------------------------------------------
for m = 1:length(GLM.result)
    % ==================================================
    % COLUMNS
    % --------------------------------------------------
    l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
    % --------------------------------------------------
    % Column: 1
    S.c(i(1)).c(i(2)).el = 'div';
    S.c(i(1)).c(i(2)).class = 'col-xs-12 col-sm-12 col-md-6 col-lg-4 col-xl-3 mb-3';
    % --------------------------------------------------
    l = 3; i(l) = i(l) + 1; i(l+1:end) = 0;
    % ==================================================
    % CARD
    S.c(i(1)).c(i(2)).c(i(3)).el = 'div';
    S.c(i(1)).c(i(2)).c(i(3)).class = 'card h-100 mb-3';
    % --------------------------------------------------
    l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
    % --------------------------------------------------
    % Card header
    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'card-header text-capitalize fw-bold';
    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).content = sprintf('%s', GLM.result(m).label);
    % --------------------------------------------------
    l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
    % --------------------------------------------------
    % Card body
    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'card-body pb-0';
    for c = 1:length(GLM.result(m).t)
        if c > 1
            % --------------------------------------------------
            l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Card body content
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'hr';
        end
        % --------------------------------------------------
        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Card body content
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'd-inline';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = GLM.result(m).t(c).title;
        % --------------------------------------------------
        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Card body content
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'button';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).type = 'button';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'btn btn-outline-secondary btn-sm float-end px-1 py-0';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).data_bs_toggle = 'modal';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).data_bs_target = sprintf('#modal-t-m%i-c%i', m, c);
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'details';
        % --------------------------------------------------
        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Card body content
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'img';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'd-block w-100 mt-3';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).style = 'max-width: 510px;';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).src = sprintf('images/result_t_m%i_c%i.png', m, c);
    end
end
% ==================================================
% MODALS
% ==================================================
% Modal for zoomed in version of the topomap
% --------------------------------------------------
l = 1; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Modal
S.c(i(1)).el = 'div';
S.c(i(1)).class = 'modal modal-xl fade';
S.c(i(1)).id = 'modal-topomap';
S.c(i(1)).tabindex = '-1';
S.c(i(1)).aria_labelledby = 'modallabel-topomap';
S.c(i(1)).aria_hidden = 'true';
% --------------------------------------------------
l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Modal dialog
S.c(i(1)).c(i(2)).el = 'div';
S.c(i(1)).c(i(2)).class = 'modal-dialog';
% --------------------------------------------------
l = 3; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Modal content
S.c(i(1)).c(i(2)).c(i(3)).el = 'div';
S.c(i(1)).c(i(2)).c(i(3)).class = 'modal-content';
% --------------------------------------------------
l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Modal header
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'modal-header';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Modal header content
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h4';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).id = 'modallabel-topomap';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'modal-title text-capitalize';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Topographic surface';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Modal close button
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'button';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).type = 'button';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'btn-close';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).data_bs_dismiss = 'modal';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).aria_label = 'Close';
% --------------------------------------------------
l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Modal body
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'modal-body';
% --------------------------------------------------
l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
% --------------------------------------------------
% Modal content - image
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'img';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'w-100 mt-3';
S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).src = 'images/surface.png';
% ==================================================
% Modals for F-statistics
% --------------------------------------------------
if isfield(GLM.result, 'f')
    for m = 1:length(GLM.result)
        for c = 1:length(GLM.result(m).f)
            % --------------------------------------------------
            l = 1; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal
            S.c(i(1)).el = 'div';
            S.c(i(1)).class = 'modal modal-xl fade';
            S.c(i(1)).id = sprintf('modal-f-m%i-c%i', m, c);
            S.c(i(1)).tabindex = '-1';
            S.c(i(1)).aria_labelledby = sprintf('modallabel-f-m%i-c%i', m, c);
            S.c(i(1)).aria_hidden = 'true';
            % --------------------------------------------------
            l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal dialog
            S.c(i(1)).c(i(2)).el = 'div';
            S.c(i(1)).c(i(2)).class = 'modal-dialog';
            % --------------------------------------------------
            l = 3; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content
            S.c(i(1)).c(i(2)).c(i(3)).el = 'div';
            S.c(i(1)).c(i(2)).c(i(3)).class = 'modal-content';
            % --------------------------------------------------
            l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal header
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'modal-header';
            % --------------------------------------------------
            l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal header content
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h4';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).id = sprintf('modallabel-f-m%i-c%i', m, c);
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'modal-title text-capitalize';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = sprintf('%s - %s', GLM.result(m).label, GLM.result(m).f(c).title);
            % --------------------------------------------------
            l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal close button
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'button';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).type = 'button';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'btn-close';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).data_bs_dismiss = 'modal';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).aria_label = 'Close';
            % --------------------------------------------------
            l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal body
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'modal-body';
            % --------------------------------------------------
            l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - image
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'img';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'w-100 mt-3';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).style = 'max-width: 510px;';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).src = sprintf('images/result_f_m%i_c%i.png', m, c);
            % ==================================================
            % TABLE FOR CLUSTERS
            % --------------------------------------------------
            switch GLM.poststats.Method
                case {'ClusterMass', 'ClusterExtent'}
                    if isempty(GLM.result(m).f(c).cluster)
                        % --------------------------------------------------
                        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'hr';
                        % --------------------------------------------------
                        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'fst-italic';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'No significant clusters';
                    else
                        % --------------------------------------------------
                        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'hr';
                        % --------------------------------------------------
                        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h5';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'fw-bold';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Cluster statistics';
                        % --------------------------------------------------
                        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'table';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'table table-hover table-sm';
                        % --------------------------------------------------
                        l = 6; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table header
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).el = 'thead';
                        % --------------------------------------------------
                        l = 7; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table row
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).el = 'tr';
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table row header
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'cluster';
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table row header
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'channels';
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table row header
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'size';
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table row header
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_clust';
                        for clust = 1:length(GLM.result(m).f(c).cluster)
                            % --------------------------------------------------
                            l = 7; i(l) = i(l) + 1; i(l+1:end) = 0;
                            % --------------------------------------------------
                            % Modal content - table body row
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).el = 'tr';
                            % --------------------------------------------------
                            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                            % --------------------------------------------------
                            % Modal content - table body row id (cluster index)
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = 'align-top fst-italic';
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'row';
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%i', clust);
                            % --------------------------------------------------
                            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                            % --------------------------------------------------
                            % Modal content - table element
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = 'align-top';
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%s', strjoin({GLM.result(m).f(c).cluster(clust).chanlocs.labels}, ', '));
                            % --------------------------------------------------
                            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                            % --------------------------------------------------
                            % Modal content - table element
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = 'align-top';
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%i', GLM.result(m).f(c).cluster(clust).size);
                            % --------------------------------------------------
                            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                            % --------------------------------------------------
                            % Modal content - table element
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = 'align-top';
                            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).f(c).cluster(clust).p_clust);
                        end
                    end
            end
            % ==================================================
            % TABLE FOR CHANNEL STATISTICS
            % --------------------------------------------------
            l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'hr';
            % --------------------------------------------------
            l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h5';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'fw-bold';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Individual channel statistics';
            % --------------------------------------------------
            l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'table';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'table table-sortable table-hover table-sm';
            % --------------------------------------------------
            l = 6; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table header
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).el = 'thead';
            % --------------------------------------------------
            l = 7; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table row
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).el = 'tr';
            % --------------------------------------------------
            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table row header
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'channel';
            % --------------------------------------------------
            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table row header
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'label';
            % --------------------------------------------------
            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table row header
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'F';
            % --------------------------------------------------
            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table row header
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_unc';
            switch GLM.poststats.Method
                case {'ClusterMass', 'ClusterExtent', 'Uncorrected'}
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_fwe';
                case 'TFCE'
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_tfce';
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_fwe';
                case 'FDR'
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_fdr';
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_fwe';
            end
            % --------------------------------------------------
            l = 6; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table body
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).el = 'tbody';
            for chan = 1:length(GLM.chanlocs)
                switch GLM.poststats.Method
                    case {'ClusterMass', 'ClusterExtent'}
                        if GLM.result(m).f(c).p_fwe(chan) <= GLM.poststats.ChanWiseAlpha
                            class = 'text-success';
                        elseif GLM.result(m).f(c).p_perm(chan) <= GLM.poststats.ClusterAlpha
                            class = 'text-primary';
                        elseif GLM.result(m).f(c).p_unc(chan) <= GLM.poststats.ChanWiseAlpha
                            class = 'text-warning';
                        else
                            class = 'text-dark';
                        end
                    case 'TFCE'
                        if GLM.result(m).f(c).p_fwe(chan) <= GLM.poststats.ChanWiseAlpha
                            class = 'text-success';
                        elseif GLM.result(m).f(c).p_perm(chan) <= GLM.poststats.ChanWiseAlpha
                            class = 'text-primary';
                        elseif GLM.result(m).f(c).p_unc(chan) <= GLM.poststats.ChanWiseAlpha
                            class = 'text-warning';
                        else
                            class = 'text-dark';
                        end
                    case 'FDR'
                        if GLM.result(m).f(c).p_fwe(chan) <= GLM.poststats.ChanWiseAlpha
                            class = 'text-success';
                        elseif GLM.result(m).f(c).p_fdr(chan) <= GLM.poststats.ChanWiseAlpha
                            class = 'text-primary';
                        elseif GLM.result(m).f(c).p_unc(chan) <= GLM.poststats.ChanWiseAlpha
                            class = 'text-warning';
                        else
                            class = 'text-dark';
                        end
                    otherwise
                        if GLM.result(m).f(c).p_fwe(chan) <= GLM.poststats.ChanWiseAlpha
                            class = 'text-success';
                        elseif GLM.result(m).f(c).p_unc(chan) <= GLM.poststats.ChanWiseAlpha
                            class = 'text-warning';
                        else
                            class = 'text-dark';
                        end
                end
                % --------------------------------------------------
                l = 7; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Modal content - table body row
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).el = 'tr';
                % --------------------------------------------------
                l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Modal content - table body row id (channel label)
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'row';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%i', chan);
                % --------------------------------------------------
                l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Modal content - table body row id (channel label)
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = GLM.chanlocs(chan).labels;
                % --------------------------------------------------
                l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Modal content - table element
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).f(c).stat(chan));
                % --------------------------------------------------
                l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Modal content - table element
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).f(c).p_unc(chan));
                switch GLM.poststats.Method
                    case {'ClusterMass', 'ClusterExtent', 'Uncorrected'}
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table row header
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).f(c).p_fwe(chan));
                    case 'TFCE'
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table row header
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).f(c).p_perm(chan));
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table row header
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).f(c).p_fwe(chan));
                    case 'FDR'
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table row header
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).f(c).p_fdr(chan));
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table row header
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).f(c).p_fwe(chan));
                end
            end
        end
    end
end
% ==================================================
% Modals for T-statistics
% --------------------------------------------------
for m = 1:length(GLM.result)
    for c = 1:length(GLM.result(m).t)
        % --------------------------------------------------
        l = 1; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal
        S.c(i(1)).el = 'div';
        S.c(i(1)).class = 'modal modal-xl fade';
        S.c(i(1)).id = sprintf('modal-t-m%i-c%i', m, c);
        S.c(i(1)).tabindex = '-1';
        S.c(i(1)).aria_labelledby = sprintf('modallabel-t-m%i-c%i', m, c);
        S.c(i(1)).aria_hidden = 'true';
        % --------------------------------------------------
        l = 2; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal dialog
        S.c(i(1)).c(i(2)).el = 'div';
        S.c(i(1)).c(i(2)).class = 'modal-dialog';
        % --------------------------------------------------
        l = 3; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content
        S.c(i(1)).c(i(2)).c(i(3)).el = 'div';
        S.c(i(1)).c(i(2)).c(i(3)).class = 'modal-content';
        % --------------------------------------------------
        l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal header
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'modal-header';
        % --------------------------------------------------
        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal header content
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h4';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).id = sprintf('modallabel-t-m%i-c%i', m, c);
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'modal-title text-capitalize';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = sprintf('%s - %s', GLM.result(m).label, GLM.result(m).t(c).title);
        % --------------------------------------------------
        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal close button
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'button';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).type = 'button';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'btn-close';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).data_bs_dismiss = 'modal';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).aria_label = 'Close';
        % --------------------------------------------------
        l = 4; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal body
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).el = 'div';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).class = 'modal-body';
        % --------------------------------------------------
        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - image
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'img';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'w-100 mt-3';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).style = 'max-width: 1020px;';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).src = sprintf('images/result_t_m%i_c%i.png', m, c);
        % ==================================================
        % TABLE FOR CLUSTERS
        % --------------------------------------------------
        switch GLM.poststats.Method
            case {'ClusterMass', 'ClusterExtent'}
                if isempty(GLM.result(m).t(c).cluster)
                    % --------------------------------------------------
                    l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'hr';
                    % --------------------------------------------------
                    l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h6';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'fst-italic';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'No significant clusters';
                else
                    % --------------------------------------------------
                    l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'hr';
                    % --------------------------------------------------
                    l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h5';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'fw-bold';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Cluster statistics';
                    % --------------------------------------------------
                    l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'table';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'table table-hover table-sm';
                    % --------------------------------------------------
                    l = 6; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).el = 'thead';
                    % --------------------------------------------------
                    l = 7; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).el = 'tr';
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'cluster';
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'channels';
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'size';
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_clust';
                    for clust = 1:length(GLM.result(m).t(c).cluster)
                        % --------------------------------------------------
                        l = 7; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table body row
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).el = 'tr';
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table body row id (cluster index)
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = 'align-top fst-italic';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'row';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%i', clust);
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table element
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = 'align-top';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%s', strjoin({GLM.result(m).t(c).cluster(clust).chanlocs.labels}, ', '));
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table element
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = 'align-top';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%i', GLM.result(m).t(c).cluster(clust).size);
                        % --------------------------------------------------
                        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                        % --------------------------------------------------
                        % Modal content - table element
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = 'align-top';
                        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).t(c).cluster(clust).p_clust);
                    end
                end
        end
        % --------------------------------------------------
        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - table
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'hr';
        % --------------------------------------------------
        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - table
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'h5';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'fw-bold';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).content = 'Individual channel statistics';
        % --------------------------------------------------
        l = 5; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - table
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).el = 'table';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).class = 'table table-sortable table-hover table-sm';
        % --------------------------------------------------
        l = 6; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - table header
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).el = 'thead';
        % --------------------------------------------------
        l = 7; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - table row
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).el = 'tr';
        % --------------------------------------------------
        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - table row header
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'channel';
        % --------------------------------------------------
        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - table row header
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'label';
        % --------------------------------------------------
        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - table row header
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'T';
        % --------------------------------------------------
        l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - table row header
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_unc';
        switch GLM.poststats.Method
            case {'ClusterMass', 'ClusterExtent', 'Uncorrected'}
                % --------------------------------------------------
                l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Modal content - table row header
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_fwe';
            case 'TFCE'
                % --------------------------------------------------
                l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Modal content - table row header
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_tfce';
                % --------------------------------------------------
                l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Modal content - table row header
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_fwe';
            case 'FDR'
                % --------------------------------------------------
                l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Modal content - table row header
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_fdr';
                % --------------------------------------------------
                l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                % --------------------------------------------------
                % Modal content - table row header
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'col';
                S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = 'p_fwe';
        end
        % --------------------------------------------------
        l = 6; i(l) = i(l) + 1; i(l+1:end) = 0;
        % --------------------------------------------------
        % Modal content - table body
        S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).el = 'tbody';
        for chan = 1:length(GLM.chanlocs)
            switch GLM.poststats.Method
                case {'ClusterMass', 'ClusterExtent'}
                    if GLM.result(m).t(c).p_fwe(chan) <= GLM.poststats.ChanWiseAlpha
                        class = 'text-success';
                    elseif GLM.result(m).t(c).p_perm(chan) <= GLM.poststats.ClusterAlpha
                        class = 'text-primary';
                    elseif GLM.result(m).t(c).p_unc(chan) <= GLM.poststats.ChanWiseAlpha
                        class = 'text-warning';
                    else
                        class = 'text-dark';
                    end
                case 'TFCE'
                    if GLM.result(m).t(c).p_fwe(chan) <= GLM.poststats.ChanWiseAlpha
                        class = 'text-success';
                    elseif GLM.result(m).t(c).p_perm(chan) <= GLM.poststats.ChanWiseAlpha
                        class = 'text-primary';
                    elseif GLM.result(m).t(c).p_unc(chan) <= GLM.poststats.ChanWiseAlpha
                        class = 'text-warning';
                    else
                        class = 'text-dark';
                    end
                case 'FDR'
                    if GLM.result(m).t(c).p_fwe(chan) <= GLM.poststats.ChanWiseAlpha
                        class = 'text-success';
                    elseif GLM.result(m).t(c).p_fdr(chan) <= GLM.poststats.ChanWiseAlpha
                        class = 'text-primary';
                    elseif GLM.result(m).t(c).p_unc(chan) <= GLM.poststats.ChanWiseAlpha
                        class = 'text-warning';
                    else
                        class = 'text-dark';
                    end
                otherwise
                    if GLM.result(m).t(c).p_fwe(chan) <= GLM.poststats.ChanWiseAlpha
                        class = 'text-success';
                    elseif GLM.result(m).t(c).p_unc(chan) <= GLM.poststats.ChanWiseAlpha
                        class = 'text-warning';
                    else
                        class = 'text-dark';
                    end
            end
            % --------------------------------------------------
            l = 7; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table body row
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).el = 'tr';
            % --------------------------------------------------
            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table body row id (channel label)
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'th';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).scope = 'row';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%i', chan);
            % --------------------------------------------------
            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table body row id (channel label)
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = GLM.chanlocs(chan).labels;
            % --------------------------------------------------
            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table element
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).t(c).stat(chan));
            % --------------------------------------------------
            l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
            % --------------------------------------------------
            % Modal content - table element
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
            S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).t(c).p_unc(chan));
            switch GLM.poststats.Method
                case {'ClusterMass', 'ClusterExtent', 'Uncorrected'}
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).t(c).p_fwe(chan));
                case 'TFCE'
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).t(c).p_perm(chan));
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).t(c).p_fwe(chan));
                case 'FDR'
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).t(c).p_fdr(chan));
                    % --------------------------------------------------
                    l = 8; i(l) = i(l) + 1; i(l+1:end) = 0;
                    % --------------------------------------------------
                    % Modal content - table row header
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).el = 'td';
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).class = class;
                    S.c(i(1)).c(i(2)).c(i(3)).c(i(4)).c(i(5)).c(i(6)).c(i(7)).c(i(8)).content = sprintf('%.6g', GLM.result(m).t(c).p_fwe(chan));
            end
        end
    end
end
% ==================================================
% Write HTML file and open the site in a browser
writeHTML(FullFilePath, S);
web(FullFilePath, '-browser');

end